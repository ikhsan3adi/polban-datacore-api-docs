{
  "openapi": "3.0.2",
  "info": {
    "title": "Polban DataVerse - DataCore API",
    "version": "1.1.1",
    "contact": {
      "name": "Ikhsan Satriadi",
      "email": "ikhsan.satriadi.tif24@polban.ac.id",
      "url": "https://github.com/ikhsan3adi/"
    }
  },
  "externalDocs": {
    "description": "GitHub Repository",
    "url": "https://github.com/muhamadSyahid/polban-datacore/"
  },
  "servers": [
    {
      "url": "http://localhost:3000",
      "description": "Development"
    },
    {
      "url": "http://localhost:6767",
      "description": "Dummy"
    },
    {
      "url": "https://datacore.polbandataverse.ac.id",
      "description": "Production (Example)"
    }
  ],
  "tags": [
    {
      "name": "DataView - Guest",
      "description": "Endpoint publik tanpa autentikasi."
    },
    {
      "name": "DataView - Akademik",
      "description": "Endpoint terkait data akademik (memerlukan autentikasi)."
    },
    {
      "name": "DataView - Kemahasiswaan",
      "description": "Endpoint terkait data kemahasiswaan (memerlukan autentikasi)."
    },
    {
      "name": "DataCore",
      "description": "Endpoint autentikasi dan admin DataCore."
    }
  ],
  "paths": {
    "/api/v1/guest/mahasiswa/gender": {
      "get": {
        "tags": [
          "DataView - Guest"
        ],
        "summary": "Get Mahasiswa Gender (Guest)",
        "description": "Mengambil data agregat jumlah mahasiswa berdasarkan jenis kelamin untuk semua angkatan.",
        "responses": {
          "200": {
            "description": "Data jenis kelamin mahasiswa (Guest)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JenisTotalArray"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/guest/mahasiswa/jenis-slta": {
      "get": {
        "tags": [
          "DataView - Guest"
        ],
        "summary": "Get Mahasiswa Jenis SLTA (Guest)",
        "description": "Mengambil data agregat jumlah mahasiswa berdasarkan jenis SLTA untuk semua angkatan.",
        "responses": {
          "200": {
            "description": "Data jenis SLTA mahasiswa (Guest)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JenisTotalArray"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/guest/mahasiswa/rasio-dosen-mhs": {
      "get": {
        "tags": [
          "DataView - Guest"
        ],
        "summary": "Get Rasio Dosen dan Mahasiswa (Guest)",
        "description": "Mengambil data rasio total dosen terhadap total mahasiswa.",
        "responses": {
          "200": {
            "description": "Data rasio dosen dan mahasiswa",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GuestRasioDosenMhs"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/guest/mahasiswa/domisili": {
      "get": {
        "tags": [
          "DataView - Guest"
        ],
        "summary": "Get Persebaran Domisili Mahasiswa (Guest)",
        "description": "Mengambil data persebaran domisili mahasiswa. Jika parameter 'provinsi' diberikan, akan mengembalikan persebaran kota di provinsi tersebut. Jika tidak, akan mengembalikan persebaran provinsi.",
        "parameters": [
          {
            "$ref": "#/components/parameters/ProvinsiQuery"
          }
        ],
        "responses": {
          "200": {
            "description": "Data persebaran domisili (provinsi atau kota)",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/GuestDomisiliAll"
                    },
                    {
                      "$ref": "#/components/schemas/GuestDomisiliProvinsi"
                    }
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/guest/mahasiswa/agama": {
      "get": {
        "tags": [
          "DataView - Guest"
        ],
        "summary": "Get Mahasiswa Agama (Guest)",
        "description": "Mengambil data agregat jumlah mahasiswa berdasarkan agama untuk semua angkatan.",
        "responses": {
          "200": {
            "description": "Data agama mahasiswa (Guest)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgamaTotalArray"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/guest/akademik/tipe-tes-masuk": {
      "get": {
        "tags": [
          "DataView - Guest"
        ],
        "summary": "Get Tipe Tes Masuk (Guest)",
        "description": "Mengambil data tipe tes masuk mahasiswa keseluruhan.",
        "responses": {
          "200": {
            "description": "Data tipe tes masuk (all)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AkademikTipeTesMasukAll"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/akademik/distribusi-nilai": {
      "get": {
        "tags": [
          "DataView - Akademik"
        ],
        "summary": "Get Distribusi Nilai",
        "description": "Mengambil data distribusi indeks nilai per mata kuliah. (Memerlukan autentikasi).",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AngkatanQuery"
          },
          {
            "$ref": "#/components/parameters/ProdiQuery"
          }
        ],
        "responses": {
          "200": {
            "description": "Data distribusi nilai",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AkademikDistribusiNilai"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/api/v1/akademik/tren-ip-rata-rata": {
      "get": {
        "tags": [
          "DataView - Akademik"
        ],
        "summary": "Get Tren IP Rata-Rata",
        "description": "Mengambil data tren IP rata-rata per semester untuk angkatan tertentu. (Memerlukan autentikasi).",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AngkatanQuery"
          }
        ],
        "responses": {
          "200": {
            "description": "Data tren IP rata-rata",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AkademikTrenIpRataRata"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/api/v1/akademik/tren-ip-tertinggi": {
      "get": {
        "tags": [
          "DataView - Akademik"
        ],
        "summary": "Get Tren IP Tertinggi",
        "description": "Mengambil data tren IP tertinggi. Jika parameter 'semester' diberikan, akan mengembalikan IP tertinggi per angkatan untuk semester tsb. Jika tidak, akan mengembalikan IP tertinggi per semester untuk angkatan default. (Memerlukan autentikasi).",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/SemesterQuery"
          },
          {
            "$ref": "#/components/parameters/AngkatanQuery"
          }
        ],
        "responses": {
          "200": {
            "description": "Data tren IP tertinggi (per angkatan atau per semester)",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/AkademikTrenIpTertinggiAngkatan"
                    },
                    {
                      "$ref": "#/components/schemas/AkademikTrenIpTertinggiSemester"
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/api/v1/akademik/tipe-tes-masuk": {
      "get": {
        "tags": [
          "DataView - Akademik"
        ],
        "summary": "Get Tipe Tes Masuk",
        "description": "Mengambil data tipe tes masuk mahasiswa. Dapat difilter berdasarkan 'kelas', 'prodi', atau default (angkatan). (Memerlukan autentikasi).",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AngkatanQuery"
          },
          {
            "$ref": "#/components/parameters/ProdiQuery"
          },
          {
            "$ref": "#/components/parameters/KelasQuery"
          }
        ],
        "responses": {
          "200": {
            "description": "Data tipe tes masuk (per angkatan, prodi, atau kelas)",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/AkademikTipeTesMasukAngkatan"
                    },
                    {
                      "$ref": "#/components/schemas/AkademikTipeTesMasukProdi"
                    },
                    {
                      "$ref": "#/components/schemas/AkademikTipeTesMasukKelas"
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/api/v1/mahasiswa/jumlah-mahasiswa": {
      "get": {
        "tags": [
          "DataView - Kemahasiswaan"
        ],
        "summary": "Get Jumlah Mahasiswa",
        "description": "Mengambil data jumlah mahasiswa. Jika parameter 'prodi' diberikan, akan mengembalikan jumlah per kelas dalam prodi tsb. Jika tidak, akan mengembalikan jumlah per prodi dalam angkatan default. (Memerlukan autentikasi).",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AngkatanQuery"
          },
          {
            "$ref": "#/components/parameters/ProdiQuery"
          }
        ],
        "responses": {
          "200": {
            "description": "Data jumlah mahasiswa (per prodi atau per kelas)",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/MahasiswaJumlahAngkatan"
                    },
                    {
                      "$ref": "#/components/schemas/MahasiswaJumlahProdi"
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/api/v1/mahasiswa/gender": {
      "get": {
        "tags": [
          "DataView - Kemahasiswaan"
        ],
        "summary": "Get Mahasiswa Gender",
        "description": "Mengambil data agregat jenis kelamin mahasiswa. Dapat difilter berdasarkan 'kelas', 'prodi', atau default (angkatan). (Memerlukan autentikasi).",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AngkatanQuery"
          },
          {
            "$ref": "#/components/parameters/KelasQuery"
          },
          {
            "$ref": "#/components/parameters/ProdiQuery"
          }
        ],
        "responses": {
          "200": {
            "description": "Data jenis kelamin mahasiswa (per angkatan, prodi, atau kelas)",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/MahasiswaGenderAngkatan"
                    },
                    {
                      "$ref": "#/components/schemas/MahasiswaGenderProdi"
                    },
                    {
                      "$ref": "#/components/schemas/MahasiswaGenderKelas"
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/api/v1/mahasiswa/jenis-slta": {
      "get": {
        "tags": [
          "DataView - Kemahasiswaan"
        ],
        "summary": "Get Mahasiswa Jenis SLTA",
        "description": "Mengambil data agregat jenis SLTA mahasiswa. Dapat difilter berdasarkan 'kelas', 'prodi', atau default (angkatan). (Memerlukan autentikasi).",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AngkatanQuery"
          },
          {
            "$ref": "#/components/parameters/KelasQuery"
          },
          {
            "$ref": "#/components/parameters/ProdiQuery"
          }
        ],
        "responses": {
          "200": {
            "description": "Data jenis SLTA mahasiswa (per angkatan, prodi, atau kelas)",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/MahasiswaSltaAngkatan"
                    },
                    {
                      "$ref": "#/components/schemas/MahasiswaSltaProdi"
                    },
                    {
                      "$ref": "#/components/schemas/MahasiswaSltaKelas"
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/api/v1/mahasiswa/agama": {
      "get": {
        "tags": [
          "DataView - Kemahasiswaan"
        ],
        "summary": "Get Mahasiswa Agama",
        "description": "Mengambil data agregat agama mahasiswa. Dapat difilter berdasarkan 'kelas', 'prodi', atau default (angkatan). (Memerlukan autentikasi).",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "$ref": "#/components/parameters/AngkatanQuery"
          },
          {
            "$ref": "#/components/parameters/KelasQuery"
          },
          {
            "$ref": "#/components/parameters/ProdiQuery"
          }
        ],
        "responses": {
          "200": {
            "description": "Data agama mahasiswa (per angkatan, prodi, atau kelas)",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "$ref": "#/components/schemas/MahasiswaAgamaAngkatan"
                    },
                    {
                      "$ref": "#/components/schemas/MahasiswaAgamaProdi"
                    },
                    {
                      "$ref": "#/components/schemas/MahasiswaAgamaKelas"
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/api/auth/login": {
      "post": {
        "tags": [
          "DataCore"
        ],
        "summary": "Login untuk DataCore dan DataView",
        "description": "Using DataHub API",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "email": {
                    "type": "string"
                  },
                  "password": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Login Success",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "message": {
                      "type": "string"
                    },
                    "token": {
                      "type": "string"
                    },
                    "user": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "integer"
                        },
                        "name": {
                          "type": "string"
                        },
                        "email": {
                          "type": "string"
                        },
                        "role": {
                          "type": "string"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized/Wrong Credentials",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "message": {
                      "type": "string"
                    },
                    "error": {
                      "type": "string"
                    },
                    "statusCode": {
                      "type": "number",
                      "example": "401"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/auth/logout": {
      "post": {
        "tags": [
          "DataCore"
        ],
        "summary": "Logout untuk DataCore dan DataView",
        "description": "Using DataHub API",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/datacore/dashboard/stats": {
      "get": {
        "tags": [
          "DataCore"
        ],
        "summary": "Data statistik dashboard ringkas",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "lastSync": {
                      "type": "object",
                      "properties": {
                        "status": {
                          "type": "string",
                          "example": "success"
                        },
                        "finishedAt": {
                          "type": "string",
                          "description": "Date",
                          "example": "2025-11-23T04:08:22.617Z"
                        },
                        "duration": {
                          "type": "string",
                          "example": "0.1s"
                        }
                      }
                    },
                    "queue": {
                      "type": "object",
                      "properties": {
                        "active": {
                          "type": "integer"
                        },
                        "waiting": {
                          "type": "integer"
                        },
                        "failed": {
                          "type": "integer",
                          "example": 6
                        }
                      }
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "totalMahasiswa": {
                          "type": "number",
                          "example": 253
                        },
                        "totalDosen": {
                          "type": "number"
                        },
                        "totalDataAkademik": {
                          "type": "number"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/api/datacore/jobs/history": {
      "get": {
        "tags": [
          "DataCore"
        ],
        "summary": "Get all ETL job history",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "description": "Halaman",
            "required": true,
            "schema": {
              "type": "integer"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Jumlah data per halaman",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 10
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "data": {
                      "type": "array",
                      "items": {
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "jobName": {
                            "type": "string"
                          },
                          "status": {
                            "type": "string"
                          },
                          "triggeredBy": {
                            "type": "string",
                            "example": "cron"
                          },
                          "startTime": {
                            "type": "string",
                            "description": "Date"
                          },
                          "endTime": {
                            "type": "string",
                            "description": "Date"
                          },
                          "duration": {
                            "type": "string",
                            "example": "0.1s"
                          }
                        }
                      }
                    },
                    "meta": {
                      "properties": {
                        "total": {
                          "type": "integer"
                        },
                        "page": {
                          "type": "integer"
                        },
                        "perPage": {
                          "type": "integer"
                        },
                        "lastPage": {
                          "type": "integer"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/api/datacore/jobs/history/{id}": {
      "get": {
        "tags": [
          "DataCore"
        ],
        "summary": "Get single ETL job history",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "The etl_job_log id",
            "schema": {
              "type": "string"
            },
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "data": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "jobName": {
                          "type": "string"
                        },
                        "status": {
                          "type": "string"
                        },
                        "triggeredBy": {
                          "type": "string",
                          "example": "cron"
                        },
                        "startTime": {
                          "type": "string",
                          "description": "Date"
                        },
                        "endTime": {
                          "type": "string",
                          "description": "Date"
                        },
                        "logMessage": {
                          "type": "string"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/api/datacore/cache/keys": {
      "get": {
        "tags": [
          "DataCore"
        ],
        "deprecated": true,
        "summary": "[JSON Viewer] Get All Cache keys",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "data": {
                      "type": "array",
                      "example": [
                        "guest:mahasiswa:gender",
                        "guest:mahasiswa:domisili:all",
                        "guest:mahasiswa:agama",
                        "guest:mahasiswa:jenis-slta",
                        "guest:mahasiswa:domisili:provinsi:jawa_barat",
                        "guest:mahasiswa:domisili:provinsi:dki_jakarta",
                        "guest:mahasiswa:domisili:provinsi:jawa_tengah",
                        "kemahasiswaan:gender",
                        "kemahasiswaan:jenis-slta",
                        "kemahasiswaan:agama",
                        "akademik:tipe-tes-masuk"
                      ],
                      "items": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/api/datacore/cache/{key}": {
      "get": {
        "tags": [
          "DataCore"
        ],
        "deprecated": true,
        "summary": "[JSON Viewer] Get JSON Cache Detail",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "key",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string",
              "example": "guest:mahasiswa:gender"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "jsonData": {
                      "type": "object",
                      "description": "Actual json cache data"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/api/datacore/inspector/mv": {
      "get": {
        "tags": [
          "DataCore"
        ],
        "summary": "[MV Inspector] Get List of Materialized View names",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "data": {
                      "type": "array",
                      "example": [
                        "mv_mahasiswa_gender",
                        "mv_mahasiswa_agama",
                        "mv_mahasiswa_slta_kategori",
                        "mv_mahasiswa_jalur_daftar",
                        "mv_mahasiswa_total",
                        "mv_mahasiswa_domisili"
                      ],
                      "items": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/api/datacore/inspector/mv/{mvName}": {
      "get": {
        "tags": [
          "DataCore"
        ],
        "summary": "[MV Inspector] Get Detailed Materialized View Data",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "mvName",
            "required": true,
            "in": "path",
            "description": "Materialized View Table Name",
            "schema": {
              "type": "string",
              "example": "mv_mahasiswa_gender"
            }
          },
          {
            "name": "q",
            "required": false,
            "in": "query",
            "description": "Search Keyword",
            "schema": {
              "type": "string",
              "example": "Jawa Barat"
            }
          },
          {
            "name": "page",
            "required": true,
            "in": "query",
            "description": "Halaman",
            "schema": {
              "type": "integer"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "description": "Jumlah data per halaman",
            "schema": {
              "type": "integer",
              "default": 10
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "oneOf": [
                          {
                            "description": "mv_mahasiswa_gender & mv_mahasiswa_slta_kategori",
                            "properties": {
                              "angkatan": {
                                "type": "integer",
                                "example": 2024
                              },
                              "jenis": {
                                "type": "string"
                              },
                              "total": {
                                "type": "integer"
                              }
                            }
                          },
                          {
                            "description": "mv_mahasiswa_agama",
                            "properties": {
                              "angkatan": {
                                "type": "integer",
                                "example": 2024
                              },
                              "agama": {
                                "type": "string"
                              },
                              "total": {
                                "type": "integer"
                              }
                            }
                          },
                          {
                            "description": "mv_mahasiswa_jalur_daftar",
                            "properties": {
                              "angkatan": {
                                "type": "integer",
                                "example": 2025
                              },
                              "tipe": {
                                "type": "string"
                              },
                              "total": {
                                "type": "integer"
                              }
                            }
                          },
                          {
                            "description": "mv_mahasiswa_total",
                            "properties": {
                              "angkatan": {
                                "type": "integer",
                                "example": 2023
                              },
                              "total": {
                                "type": "integer"
                              }
                            }
                          },
                          {
                            "description": "mv_mahasiswa_domisili",
                            "properties": {
                              "namaProvinsi": {
                                "type": "string"
                              },
                              "provinsiLat": {
                                "type": "number",
                                "example": -6.9175
                              },
                              "provinsiLng": {
                                "type": "number",
                                "example": 107.6191
                              },
                              "namaWilayah": {
                                "type": "string"
                              },
                              "wilayahLat": {
                                "type": "number",
                                "example": -7.0208
                              },
                              "wilayahLng": {
                                "type": "number",
                                "example": 107.5192
                              },
                              "total": {
                                "type": "integer"
                              }
                            }
                          }
                        ]
                      }
                    },
                    "meta": {
                      "properties": {
                        "total": {
                          "type": "integer"
                        },
                        "page": {
                          "type": "integer"
                        },
                        "perPage": {
                          "type": "integer"
                        },
                        "lastPage": {
                          "type": "integer"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/api/jobs/run": {
      "post": {
        "tags": [
          "DataCore"
        ],
        "summary": "Trigger sync & aggregation job",
        "description": "Melakukan manual trigger untuk proses sinkronisasi dan agregasi data. (Memerlukan autentikasi).",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "jobName": {
                    "type": "string",
                    "example": "full-sync-and-aggregate"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Queue result",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "message": {
                      "type": "string"
                    },
                    "queueId": {
                      "type": "string"
                    },
                    "timestamp": {
                      "type": "string",
                      "example": "2025-11-16T09:55:09Z"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/api/jobs/schedules": {
      "get": {
        "tags": [
          "DataCore"
        ],
        "summary": "Get Scheduled Jobs",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Scheduled Jobs",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "data": {
                      "type": "array",
                      "items": {
                        "properties": {
                          "id": {
                            "type": "string",
                            "example": "qqchtxi6rakzpevjvmo2wu52"
                          },
                          "jobName": {
                            "type": "string",
                            "example": "full-sync-and-aggregate"
                          },
                          "cronExpression": {
                            "type": "string",
                            "example": "0 0 * * *"
                          },
                          "description": {
                            "type": "string",
                            "example": "Full Sync & Aggregation"
                          },
                          "isActive": {
                            "type": "boolean",
                            "example": true
                          },
                          "createdAt": {
                            "type": "string",
                            "example": "2025-11-21T11:34:42.108Z"
                          },
                          "updatedAt": {
                            "type": "string",
                            "example": "2025-11-21T14:26:54.329Z"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      },
      "put": {
        "tags": [
          "DataCore"
        ],
        "summary": "Create/Update Scheduled Jobs",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "jobName": {
                    "type": "string",
                    "example": "full-sync-and-aggregate"
                  },
                  "cronExpression": {
                    "type": "string",
                    "example": "0 0 * * *"
                  },
                  "description": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "2XX": {
            "description": "Created/Updated",
            "content": {
              "application/json": {
                "example": {
                  "message": "Schedule for full-sync-and-aggregate updated to '0 0 * * *'"
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/api/etl/debug/fullSync": {
      "get": {
        "tags": [
          "DataCore Debug"
        ],
        "summary": "[DEBUG ONLY] Direct sync & aggr trigger without queue/job",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Success"
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    },
    "/api/etl/datahub/debug/mahasiswa": {
      "get": {
        "tags": [
          "DataCore Debug"
        ],
        "summary": "[DEBUG ONLY] Debug DataHub API",
        "security": [
          {
            "BearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "properties": {
                      "angkatan": {
                        "type": "number",
                        "example": "2024"
                      },
                      "kelas": {
                        "type": "string"
                      },
                      "agama": {
                        "type": "string"
                      },
                      "jenis_kelamin": {
                        "example": "L",
                        "maxLength": 1
                      },
                      "provinsi": {
                        "type": "object"
                      },
                      "wilayah": {
                        "type": "object"
                      },
                      "slta": {
                        "type": "object"
                      },
                      "jalur_daftar": {
                        "type": "object"
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/components/responses/Forbidden"
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "Error": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string"
          },
          "error": {
            "type": "string"
          },
          "statusCore": {
            "type": "integer"
          }
        },
        "required": [
          "message"
        ]
      },
      "GeoPoint": {
        "type": "object",
        "properties": {
          "lat": {
            "type": "number",
            "format": "double"
          },
          "lng": {
            "type": "number",
            "format": "double"
          }
        }
      },
      "JenisTotal": {
        "type": "object",
        "properties": {
          "jenis": {
            "type": "string"
          },
          "total": {
            "type": "integer"
          }
        }
      },
      "JenisTotalArray": {
        "type": "object",
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/JenisTotal"
            }
          }
        }
      },
      "AgamaTotal": {
        "type": "object",
        "properties": {
          "agama": {
            "type": "string"
          },
          "total": {
            "type": "integer"
          }
        }
      },
      "AgamaTotalArray": {
        "type": "object",
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AgamaTotal"
            }
          }
        }
      },
      "TipeTotal": {
        "type": "object",
        "properties": {
          "tipe": {
            "type": "string"
          },
          "total": {
            "type": "integer"
          }
        }
      },
      "SemesterIp": {
        "type": "object",
        "properties": {
          "semester": {
            "type": "integer"
          },
          "ip": {
            "type": "number",
            "format": "float"
          }
        }
      },
      "AngkatanIp": {
        "type": "object",
        "properties": {
          "angkatan": {
            "type": "string"
          },
          "ip": {
            "type": "number",
            "format": "float"
          }
        }
      },
      "ProdiTotal": {
        "type": "object",
        "properties": {
          "prodi": {
            "type": "string"
          },
          "total": {
            "type": "integer"
          }
        }
      },
      "KelasTotal": {
        "type": "object",
        "properties": {
          "kelas": {
            "type": "string"
          },
          "total": {
            "type": "integer"
          }
        }
      },
      "IndeksNilai": {
        "type": "object",
        "properties": {
          "indeks": {
            "type": "string"
          },
          "total": {
            "type": "integer"
          }
        }
      },
      "MataKuliahNilai": {
        "type": "object",
        "properties": {
          "mata_kuliah": {
            "type": "string"
          },
          "indeks_nilai": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/IndeksNilai"
            }
          }
        }
      },
      "GuestRasioDosenMhs": {
        "type": "object",
        "properties": {
          "rasio": {
            "type": "object",
            "properties": {
              "text": {
                "type": "string"
              },
              "fraction": {
                "type": "number",
                "format": "float"
              }
            }
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/JenisTotal"
            }
          }
        }
      },
      "GuestDomisiliAll": {
        "type": "object",
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "provinsi": {
                  "type": "string"
                },
                "total": {
                  "type": "integer"
                },
                "geo": {
                  "$ref": "#/components/schemas/GeoPoint"
                }
              }
            }
          }
        }
      },
      "GuestDomisiliProvinsi": {
        "type": "object",
        "properties": {
          "provinsi": {
            "type": "string"
          },
          "data": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "kota": {
                  "type": "string"
                },
                "total": {
                  "type": "integer"
                },
                "geo": {
                  "$ref": "#/components/schemas/GeoPoint"
                }
              }
            }
          }
        }
      },
      "AkademikDistribusiNilai": {
        "type": "object",
        "properties": {
          "angkatan": {
            "type": "string"
          },
          "prodi": {
            "type": "string"
          },
          "semester": {
            "type": "integer"
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/MataKuliahNilai"
            }
          }
        }
      },
      "AkademikTrenIpRataRata": {
        "type": "object",
        "properties": {
          "angkatan": {
            "type": "string"
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SemesterIp"
            }
          }
        }
      },
      "AkademikTrenIpTertinggiAngkatan": {
        "type": "object",
        "properties": {
          "angkatan": {
            "type": "string"
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SemesterIp"
            }
          }
        }
      },
      "AkademikTrenIpTertinggiSemester": {
        "type": "object",
        "properties": {
          "semester": {
            "type": "integer"
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AngkatanIp"
            }
          }
        }
      },
      "AkademikTipeTesMasukAll": {
        "type": "object",
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TipeTotal"
            }
          }
        }
      },
      "AkademikTipeTesMasukAngkatan": {
        "type": "object",
        "properties": {
          "angkatan": {
            "type": "string"
          },
          "prodi": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TipeTotal"
            }
          }
        }
      },
      "AkademikTipeTesMasukProdi": {
        "type": "object",
        "properties": {
          "angkatan": {
            "type": "string"
          },
          "prodi": {
            "type": "string"
          },
          "kelas": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TipeTotal"
            }
          }
        }
      },
      "AkademikTipeTesMasukKelas": {
        "type": "object",
        "properties": {
          "angkatan": {
            "type": "string"
          },
          "prodi": {
            "type": "string"
          },
          "kelas": {
            "type": "string"
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TipeTotal"
            }
          }
        }
      },
      "MahasiswaJumlahAngkatan": {
        "type": "object",
        "properties": {
          "angkatan": {
            "type": "string"
          },
          "prodi": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ProdiTotal"
            }
          }
        }
      },
      "MahasiswaJumlahProdi": {
        "type": "object",
        "properties": {
          "angkatan": {
            "type": "string"
          },
          "prodi": {
            "type": "string"
          },
          "kelas": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/KelasTotal"
            }
          }
        }
      },
      "MahasiswaGenderAngkatan": {
        "type": "object",
        "properties": {
          "angkatan": {
            "type": "string"
          },
          "prodi": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/JenisTotal"
            }
          }
        }
      },
      "MahasiswaGenderProdi": {
        "type": "object",
        "properties": {
          "angkatan": {
            "type": "string"
          },
          "prodi": {
            "type": "string"
          },
          "kelas": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/JenisTotal"
            }
          }
        }
      },
      "MahasiswaGenderKelas": {
        "type": "object",
        "properties": {
          "angkatan": {
            "type": "string"
          },
          "prodi": {
            "type": "string"
          },
          "kelas": {
            "type": "string"
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/JenisTotal"
            }
          }
        }
      },
      "MahasiswaSltaAngkatan": {
        "type": "object",
        "properties": {
          "angkatan": {
            "type": "string"
          },
          "prodi": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/JenisTotal"
            }
          }
        }
      },
      "MahasiswaSltaProdi": {
        "type": "object",
        "properties": {
          "angkatan": {
            "type": "string"
          },
          "prodi": {
            "type": "string"
          },
          "kelas": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/JenisTotal"
            }
          }
        }
      },
      "MahasiswaSltaKelas": {
        "type": "object",
        "properties": {
          "angkatan": {
            "type": "string"
          },
          "prodi": {
            "type": "string"
          },
          "kelas": {
            "type": "string"
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/JenisTotal"
            }
          }
        }
      },
      "MahasiswaAgamaAngkatan": {
        "type": "object",
        "properties": {
          "angkatan": {
            "type": "string"
          },
          "prodi": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AgamaTotal"
            }
          }
        }
      },
      "MahasiswaAgamaProdi": {
        "type": "object",
        "properties": {
          "angkatan": {
            "type": "string"
          },
          "prodi": {
            "type": "string"
          },
          "kelas": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AgamaTotal"
            }
          }
        }
      },
      "MahasiswaAgamaKelas": {
        "type": "object",
        "properties": {
          "angkatan": {
            "type": "string"
          },
          "prodi": {
            "type": "string"
          },
          "kelas": {
            "type": "string"
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AgamaTotal"
            }
          }
        }
      }
    },
    "parameters": {
      "ProvinsiQuery": {
        "name": "provinsi",
        "in": "query",
        "description": "Filter berdasarkan nama provinsi.",
        "required": false,
        "schema": {
          "type": "string"
        }
      },
      "AngkatanQuery": {
        "name": "angkatan",
        "in": "query",
        "description": "Filter berdasarkan angkatan.",
        "required": false,
        "schema": {
          "type": "string"
        }
      },
      "SemesterQuery": {
        "name": "semester",
        "in": "query",
        "description": "Filter berdasarkan semester.",
        "required": false,
        "schema": {
          "type": "string"
        }
      },
      "ProdiQuery": {
        "name": "prodi",
        "in": "query",
        "description": "Filter berdasarkan kode program studi.",
        "required": false,
        "schema": {
          "type": "string"
        }
      },
      "KelasQuery": {
        "name": "kelas",
        "in": "query",
        "description": "Filter berdasarkan nama kelas.",
        "required": false,
        "schema": {
          "type": "string"
        }
      }
    },
    "responses": {
      "BadRequest": {
        "description": "Kesalahan request",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "example": {
              "message": "Kesalahan request"
            }
          }
        }
      },
      "Unauthorized": {
        "description": "Anda harus login terlebih dahulu",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "example": {
              "message": "Anda harus login terlebih dahulu",
              "error": "Unauthorized",
              "statusCode": 401
            }
          }
        }
      },
      "Forbidden": {
        "description": "Anda tidak memiliki izin untuk melakukan hal tersebut",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "example": {
              "message": "Anda tidak memiliki izin untuk melakukan hal tersebut",
              "error": "Forbidden",
              "statusCode": 403
            }
          }
        }
      },
      "NotFound": {
        "description": "Resource tidak ditemukan!",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "example": {
              "message": "Resource tidak ditemukan!"
            }
          }
        }
      },
      "InternalServerError": {
        "description": "Kesalahan server",
        "content": {
          "application/json": {
            "schema": {
              "$ref": "#/components/schemas/Error"
            },
            "example": {
              "message": "Kesalahan server"
            }
          }
        }
      }
    }
  }
}